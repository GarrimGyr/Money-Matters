<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<title>NT Map v1</title>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.6.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.6.0/mapbox-gl.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <div id="map" style= 'width: 800px; height: 600px; z-index: 0;'></div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiamRldmluZW1pdCIsImEiOiJja3dqazJkczgwcHFjMm50Z2cwczY4cnc1In0.uGy-uqSjMUgm6p7pv7aDhg';
        const map = new mapboxgl.Map({
            container: "map",
            style: 'mapbox://styles/jdevinemit/ckwjfe1dg1zy614p35779y2do',
            center: [-88.020,15.468],
            zoom: 5.75
        });

        // D3 Integration adapted from tutorial by Frank Schlosser at https://franksh.com/posts/d3-mapboxgl/

        var container = map.getCanvasContainer();
        var svg = d3
        .select(container)
        .append("svg")
        .attr("width", "800px")
        .attr("height", "600px")
        .style("position", "absolute")
        .style("z-index", 2);

        function project(d) {
            return map.project(new mapboxgl.LngLat(d[0], d[1]));
          }
        
        var data = [[-90.37, 15.70, 77.6, 29.75], [-88.86, 13.73, 24.64, 12.1], [-86.60, 14.83, 23.83, 11.55]];

        var gdp = svg
            .selectAll("circle.first")
            .data(data)
            .enter()
            .append("circle")
            .attr("r", function(d){return d[2];})
            .style("fill", "#385941");

        var remit = svg
            .selectAll("circle.second")
            .data(data)
            .enter()
            .append("circle")
            .attr("r", function(d){return d[3];})
            .style("fill", "#658C4D");

        function render() {
            gdp
            .attr("cx", function(d) {
            return project(d).x;
            })
            .attr("cy", function(d) {
            return project(d).y;
            });
            remit
            .attr("cx", function(d) {
            return project(d).x;
            })
            .attr("cy", function(d) {
            return project(d).y;
            });

              }
        
        map.on("viewreset", render);
        map.on("move", render);
        map.on("moveend", render);
        render(); // Call once to render
    </script>
</body>
</html>